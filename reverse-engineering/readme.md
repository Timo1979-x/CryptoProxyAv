# Подготовка
1. Установить [Windows 10 sdk](https://developer.microsoft.com/ru-ru/windows/downloads/windows-sdk/)

1. открыть c:\Windows\System32\crypt32.dll с помощью [nirsoft DLL Export Viewer](http://www.nirsoft.net/utils/dll_export_viewer.html). Выделить всё, вставить в редактор и произвести замену, получив список команд для WinDbg. Сохранить в файле crypt32.dbg:

    ^([^\s]+)\s.*$

    на

    bp crypt32!$1 ".printf \"xoxo: crypt32.$1\"; k 3; .echo; gc"

    Только надо убрать строки CryptProtectMemory, CryptUnprotectMemory, CryptUpdateProtectedState, т.к. на них точка останова не ставится

1. То же самое для c:\Windows\System32\advapi32.dll, сохранив в advapi32.dbg:

    ^([^\s]+)\s.*$

    на

    bp kernelbase!$1 ".printf \"xoxo: advapi32.$1\"; k3; .echo; gc"

    Только надо убрать строки AccessCheck, AccessCheckAndAuditAlarmW, AccessCheckByType, AccessCheckByTypeAndAuditAlarmW, AccessCheckByTypeResultList, AccessCheckByTypeResultListAndAuditAlarmByHandleW, AccessCheckByTypeResultListAndAuditAlarmW, AddAccessAllowedAce, AddAccessAllowedAceEx, AddAccessAllowedObjectAce, AddAccessDeniedAce, AddAccessDeniedAceEx, AddAccessDeniedObjectAce, AddAce, AddAuditAccessAce, AddAuditAccessAceEx, AddAuditAccessObjectAce, AddMandatoryAce т.к. на них точка останова не ставится

    Также, при дебаге AvCmUt4.exe нужно убрать точку останова на crypt32.I_CryptGetAsn1Decoder, CryptDecodeObject, CryptDecodeObjectEx, CryptFindOIDInfo, I_CryptAllocTlsEx, CertAlgIdToOID, CryptMemFree,   ибо просто немеряное количество вызовов.

1. запустить команду (одну из):

    ```
    "c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\windbg.exe" -c "g"  d:\work\contact\CryptoService_avest\CryptoService_41.exe
    "c:\Program Files (x86)\Windows Kits\10\Debuggers\x86\windbg.exe" -c "g" "c:\Program Files (x86)\Avest\AvPCM_nces\AvCmUt4.exe" -m -m1 -M -t -s "%~f0"
    ```

1. Вызвать подписание чего-нибудь, например с помощью TestCryptoApi, чтобы прогрузились dll-ки

1. В WinDbg приостановить процесс (Ctrl+Break), подгрузить один или несколько списков точек останова:
    
    ```
    $$<D:\work\vs\CryptoProxyAv\reverse-engineering\avpass.dbg
    $$<D:\work\vs\CryptoProxyAv\reverse-engineering\advapi32.dbg
    $$<D:\work\vs\CryptoProxyAv\reverse-engineering\crypt32.dbg
    ```

1. Результаты анализа показали, что CryptoService вообще не вызывает функций из crypt32 и advapi32, а работает напрямую с avpass.

# Посмотреть список импортированных функций
[Источник](https://tomsreversing.com/2013/03/11/viewing-imports-table/)
1. в WinDbg подключиться к процессу и вывести список загруженных dll:
    ```
    lm
    ```
    ```
    start    end        module name
    00400000 00642000   CryptoService42   (deferred)
    011e0000 011e5000   BarPciKeys   (deferred)
    ...
    ```
1. вывести заголовок интересующего модуля:
    ```
    !dh CRYPT32 -f
    ```
    Нас интересуют эти строки. Указано смещение и длина сегментов:
    ```
    F1000 [     4B0] address [size] of Import Address Table Directory
    E76E4 [     280] address [size] of Delay Import Directory
    ```
1. Пролистать импорты:
    ```
    dps CRYPT32 + F1000 CRYPT32 + F1000 + 4B0
    ```

# Экспортируемые функции:
## c:\Program Files (x86)\Avest\Avest CSP Bel\devices\AvPass.dll
- AvPassChangeKey
- AvPassCheckKey
- AvPassCleanup
- AvPassCloseDevice
- AvPassDeletePriv
- AvPassDeletePub
- AvPassEnumDevices
- AvPassEnumDevicesAndGetAmount
- AvPassGenRandom
- AvPassGetDeviceAttr
- AvPassGetDeviceAttrEx
- AvPassInit
- AvPassInitRandom
- AvPassOpenDevice
- AvPassOpenDeviceEx
- AvPassReadPriv
- AvPassReadPub
- AvPassSetKey
- AvPassWrite
- DllMain

## c:\Windows\System32\crypt32.dll
- CertAddCertificateContextToStore
- CertAddCertificateLinkToStore
- CertAddCRLContextToStore
- CertAddCRLLinkToStore
- CertAddCTLContextToStore
- CertAddCTLLinkToStore
- CertAddEncodedCertificateToStore
- CertAddEncodedCertificateToSystemStoreA
- CertAddEncodedCertificateToSystemStoreW
- CertAddEncodedCRLToStore
- CertAddEncodedCTLToStore
- CertAddEnhancedKeyUsageIdentifier
- CertAddRefServerOcspResponse
- CertAddRefServerOcspResponseContext
- CertAddSerializedElementToStore
- CertAddStoreToCollection
- CertAlgIdToOID
- CertCloseServerOcspResponse
- CertCloseStore
- CertCompareCertificate
- CertCompareCertificateName
- CertCompareIntegerBlob
- CertComparePublicKeyInfo
- CertControlStore
- CertCreateCertificateChainEngine
- CertCreateCertificateContext
- CertCreateContext
- CertCreateCRLContext
- CertCreateCTLContext
- CertCreateCTLEntryFromCertificateContextProperties
- CertCreateSelfSignCertificate
- CertDeleteCertificateFromStore
- CertDeleteCRLFromStore
- CertDeleteCTLFromStore
- CertDuplicateCertificateChain
- CertDuplicateCertificateContext
- CertDuplicateCRLContext
- CertDuplicateCTLContext
- CertDuplicateStore
- CertEnumCertificateContextProperties
- CertEnumCertificatesInStore
- CertEnumCRLContextProperties
- CertEnumCRLsInStore
- CertEnumCTLContextProperties
- CertEnumCTLsInStore
- CertEnumPhysicalStore
- CertEnumSubjectInSortedCTL
- CertEnumSystemStore
- CertEnumSystemStoreLocation
- CertFindAttribute
- CertFindCertificateInCRL
- CertFindCertificateInStore
- CertFindChainInStore
- CertFindCRLInStore
- CertFindCTLInStore
- CertFindExtension
- CertFindRDNAttr
- CertFindSubjectInCTL
- CertFindSubjectInSortedCTL
- CertFreeCertificateChain
- CertFreeCertificateChainEngine
- CertFreeCertificateChainList
- CertFreeCertificateContext
- CertFreeCRLContext
- CertFreeCTLContext
- CertFreeServerOcspResponseContext
- CertGetCertificateChain
- CertGetCertificateContextProperty
- CertGetCRLContextProperty
- CertGetCRLFromStore
- CertGetCTLContextProperty
- CertGetEnhancedKeyUsage
- CertGetIntendedKeyUsage
- CertGetIssuerCertificateFromStore
- CertGetNameStringA
- CertGetNameStringW
- CertGetPublicKeyLength
- CertGetServerOcspResponseContext
- CertGetStoreProperty
- CertGetSubjectCertificateFromStore
- CertGetValidUsages
- CertIsRDNAttrsInCertificateName
- CertIsStrongHashToSign
- CertIsValidCRLForCertificate
- CertIsWeakHash
- CertNameToStrA
- CertNameToStrW
- CertOIDToAlgId
- CertOpenServerOcspResponse
- CertOpenStore
- CertOpenSystemStoreA
- CertOpenSystemStoreW
- CertRDNValueToStrA
- CertRDNValueToStrW
- CertRegisterPhysicalStore
- CertRegisterSystemStore
- CertRemoveEnhancedKeyUsageIdentifier
- CertRemoveStoreFromCollection
- CertResyncCertificateChainEngine
- CertRetrieveLogoOrBiometricInfo
- CertSaveStore
- CertSelectCertificateChains
- CertSerializeCertificateStoreElement
- CertSerializeCRLStoreElement
- CertSerializeCTLStoreElement
- CertSetCertificateContextPropertiesFromCTLEntry
- CertSetCertificateContextProperty
- CertSetCRLContextProperty
- CertSetCTLContextProperty
- CertSetEnhancedKeyUsage
- CertSetStoreProperty
- CertStrToNameA
- CertStrToNameW
- CertUnregisterPhysicalStore
- CertUnregisterSystemStore
- CertVerifyCertificateChainPolicy
- CertVerifyCRLRevocation
- CertVerifyCRLTimeValidity
- CertVerifyCTLUsage
- CertVerifyRevocation
- CertVerifySubjectCertificateContext
- CertVerifyTimeValidity
- CertVerifyValidityNesting
- CryptAcquireCertificatePrivateKey
- CryptBinaryToStringA
- CryptBinaryToStringW
- CryptCloseAsyncHandle
- CryptCreateAsyncHandle
- CryptCreateKeyIdentifierFromCSP
- CryptDecodeMessage
- CryptDecodeObject
- CryptDecodeObjectEx
- CryptDecryptAndVerifyMessageSignature
- CryptDecryptMessage
- CryptEncodeObject
- CryptEncodeObjectEx
- CryptEncryptMessage
- CryptEnumKeyIdentifierProperties
- CryptEnumOIDFunction
- CryptEnumOIDInfo
- CryptExportPKCS8
- CryptExportPublicKeyInfo
- CryptExportPublicKeyInfoEx
- CryptExportPublicKeyInfoFromBCryptKeyHandle
- CryptFindCertificateKeyProvInfo
- CryptFindLocalizedName
- CryptFindOIDInfo
- CryptFormatObject
- CryptFreeOIDFunctionAddress
- CryptGetAsyncParam
- CryptGetDefaultOIDDllList
- CryptGetDefaultOIDFunctionAddress
- CryptGetKeyIdentifierProperty
- CryptGetMessageCertificates
- CryptGetMessageSignerCount
- CryptGetOIDFunctionAddress
- CryptGetOIDFunctionValue
- CryptHashCertificate
- CryptHashCertificate2
- CryptHashMessage
- CryptHashPublicKeyInfo
- CryptHashToBeSigned
- CryptImportPKCS8
- CryptImportPublicKeyInfo
- CryptImportPublicKeyInfoEx
- CryptImportPublicKeyInfoEx2
- CryptInitOIDFunctionSet
- CryptInstallDefaultContext
- CryptInstallOIDFunctionAddress
- CryptLoadSip
- CryptMemAlloc
- CryptMemFree
- CryptMemRealloc
- CryptMsgCalculateEncodedLength
- CryptMsgClose
- CryptMsgControl
- CryptMsgCountersign
- CryptMsgCountersignEncoded
- CryptMsgDuplicate
- CryptMsgEncodeAndSignCTL
- CryptMsgGetAndVerifySigner
- CryptMsgGetParam
- CryptMsgOpenToDecode
- CryptMsgOpenToEncode
- CryptMsgSignCTL
- CryptMsgUpdate
- CryptMsgVerifyCountersignatureEncoded
- CryptMsgVerifyCountersignatureEncodedEx
- CryptObjectLocatorFree
- CryptObjectLocatorGet
- CryptObjectLocatorGetContent
- CryptObjectLocatorGetUpdated
- CryptObjectLocatorInitialize
- CryptObjectLocatorIsChanged
- CryptObjectLocatorRelease
- CryptProtectData
- CryptProtectMemory
- CryptQueryObject
- CryptRegisterDefaultOIDFunction
- CryptRegisterOIDFunction
- CryptRegisterOIDInfo
- CryptRetrieveTimeStamp
- CryptSetAsyncParam
- CryptSetKeyIdentifierProperty
- CryptSetOIDFunctionValue
- CryptSignAndEncodeCertificate
- CryptSignAndEncryptMessage
- CryptSignCertificate
- CryptSignMessage
- CryptSignMessageWithKey
- CryptSIPAddProvider
- CryptSIPCreateIndirectData
- CryptSIPGetCaps
- CryptSIPGetSealedDigest
- CryptSIPGetSignedDataMsg
- CryptSIPLoad
- CryptSIPPutSignedDataMsg
- CryptSIPRemoveProvider
- CryptSIPRemoveSignedDataMsg
- CryptSIPRetrieveSubjectGuid
- CryptSIPRetrieveSubjectGuidForCatalogFile
- CryptSIPVerifyIndirectData
- CryptStringToBinaryA
- CryptStringToBinaryW
- CryptUninstallDefaultContext
- CryptUnprotectData
- CryptUnprotectMemory
- CryptUnregisterDefaultOIDFunction
- CryptUnregisterOIDFunction
- CryptUnregisterOIDInfo
- CryptUpdateProtectedState
- CryptVerifyCertificateSignature
- CryptVerifyCertificateSignatureEx
- CryptVerifyDetachedMessageHash
- CryptVerifyDetachedMessageSignature
- CryptVerifyMessageHash
- CryptVerifyMessageSignature
- CryptVerifyMessageSignatureWithKey
- CryptVerifyTimeStampSignature
- I_CertChainEngineIsDisallowedCertificate
- I_CertDiagControl
- I_CertFinishSslHandshake
- I_CertProcessSslHandshake
- I_CertProtectFunction
- I_CertSrvProtectFunction
- I_CertSyncStore
- I_CertUpdateStore
- I_CertWnfEnableFlushCache
- I_CryptAddRefLruEntry
- I_CryptAddSmartCardCertToStore
- I_CryptAllocTls
- I_CryptAllocTlsEx
- I_CryptCreateLruCache
- I_CryptCreateLruEntry
- I_CryptDetachTls
- I_CryptDisableLruOfEntries
- I_CryptEnableLruOfEntries
- I_CryptEnumMatchingLruEntries
- I_CryptFindLruEntry
- I_CryptFindLruEntryData
- I_CryptFindSmartCardCertInStore
- I_CryptFlushLruCache
- I_CryptFreeLruCache
- I_CryptFreeTls
- I_CryptGetAsn1Decoder
- I_CryptGetAsn1Encoder
- I_CryptGetDefaultCryptProv
- I_CryptGetDefaultCryptProvForEncrypt
- I_CryptGetFileVersion
- I_CryptGetLruEntryData
- I_CryptGetLruEntryIdentifier
- I_CryptGetOssGlobal
- I_CryptGetTls
- I_CryptInsertLruEntry
- I_CryptInstallAsn1Module
- I_CryptInstallOssGlobal
- I_CryptReadTrustedPublisherDWORDValueFromRegistry
- I_CryptRegisterSmartCardStore
- I_CryptReleaseLruEntry
- I_CryptRemoveLruEntry
- I_CryptSetTls
- I_CryptTouchLruEntry
- I_CryptUninstallAsn1Module
- I_CryptUninstallOssGlobal
- I_CryptUnregisterSmartCardStore
- I_CryptWalkAllLruCacheEntries
- I_PFXDecrypt
- I_PFXHMAC
- I_PFXImportCertStoreEx
- PFXExportCertStore
- PFXExportCertStore2
- PFXExportCertStoreEx
- PFXImportCertStore
- PFXIsPFXBlob
- PFXVerifyPassword

## c:\Windows\System32\advapi32.dll
- A_SHAFinal
- A_SHAInit
- A_SHAUpdate
- AbortSystemShutdownA
- AbortSystemShutdownW
- AccessCheck
- AccessCheckAndAuditAlarmA
- AccessCheckAndAuditAlarmW
- AccessCheckByType
- AccessCheckByTypeAndAuditAlarmA
- AccessCheckByTypeAndAuditAlarmW
- AccessCheckByTypeResultList
- AccessCheckByTypeResultListAndAuditAlarmA
- AccessCheckByTypeResultListAndAuditAlarmByHandleA
- AccessCheckByTypeResultListAndAuditAlarmByHandleW
- AccessCheckByTypeResultListAndAuditAlarmW
- AddAccessAllowedAce
- AddAccessAllowedAceEx
- AddAccessAllowedObjectAce
- AddAccessDeniedAce
- AddAccessDeniedAceEx
- AddAccessDeniedObjectAce
- AddAce
- AddAuditAccessAce
- AddAuditAccessAceEx
- AddAuditAccessObjectAce
- AddConditionalAce
- AddMandatoryAce
- AddUsersToEncryptedFile
- AddUsersToEncryptedFileEx
- AdjustTokenGroups
- AdjustTokenPrivileges
- AllocateAndInitializeSid
- AllocateLocallyUniqueId
- AreAllAccessesGranted
- AreAnyAccessesGranted
- AuditComputeEffectivePolicyBySid
- AuditComputeEffectivePolicyByToken
- AuditEnumerateCategories
- AuditEnumeratePerUserPolicy
- AuditEnumerateSubCategories
- AuditFree
- AuditLookupCategoryGuidFromCategoryId
- AuditLookupCategoryIdFromCategoryGuid
- AuditLookupCategoryNameA
- AuditLookupCategoryNameW
- AuditLookupSubCategoryNameA
- AuditLookupSubCategoryNameW
- AuditQueryGlobalSaclA
- AuditQueryGlobalSaclW
- AuditQueryPerUserPolicy
- AuditQuerySecurity
- AuditQuerySystemPolicy
- AuditSetGlobalSaclA
- AuditSetGlobalSaclW
- AuditSetPerUserPolicy
- AuditSetSecurity
- AuditSetSystemPolicy
- BackupEventLogA
- BackupEventLogW
- BaseRegCloseKey
- BaseRegCreateKey
- BaseRegDeleteKeyEx
- BaseRegDeleteValue
- BaseRegFlushKey
- BaseRegGetVersion
- BaseRegLoadKey
- BaseRegOpenKey
- BaseRegRestoreKey
- BaseRegSaveKeyEx
- BaseRegSetKeySecurity
- BaseRegSetValue
- BaseRegUnLoadKey
- BuildExplicitAccessWithNameA
- BuildExplicitAccessWithNameW
- BuildImpersonateExplicitAccessWithNameA
- BuildImpersonateExplicitAccessWithNameW
- BuildImpersonateTrusteeA
- BuildImpersonateTrusteeW
- BuildSecurityDescriptorA
- BuildSecurityDescriptorW
- BuildTrusteeWithNameA
- BuildTrusteeWithNameW
- BuildTrusteeWithObjectsAndNameA
- BuildTrusteeWithObjectsAndNameW
- BuildTrusteeWithObjectsAndSidA
- BuildTrusteeWithObjectsAndSidW
- BuildTrusteeWithSidA
- BuildTrusteeWithSidW
- CancelOverlappedAccess
- ChangeServiceConfig2A
- ChangeServiceConfig2W
- ChangeServiceConfigA
- ChangeServiceConfigW
- CheckForHiberboot
- CheckTokenMembership
- ClearEventLogA
- ClearEventLogW
- CloseCodeAuthzLevel
- CloseEncryptedFileRaw
- CloseEventLog
- CloseServiceHandle
- CloseThreadWaitChainSession
- CloseTrace
- CommandLineFromMsiDescriptor
- ComputeAccessTokenFromCodeAuthzLevel
- ControlService
- ControlServiceExA
- ControlServiceExW
- ControlTraceA
- ControlTraceW
- ConvertAccessToSecurityDescriptorA
- ConvertAccessToSecurityDescriptorW
- ConvertSDToStringSDDomainW
- ConvertSDToStringSDRootDomainA
- ConvertSDToStringSDRootDomainW
- ConvertSecurityDescriptorToAccessA
- ConvertSecurityDescriptorToAccessNamedA
- ConvertSecurityDescriptorToAccessNamedW
- ConvertSecurityDescriptorToAccessW
- ConvertSecurityDescriptorToStringSecurityDescriptorA
- ConvertSecurityDescriptorToStringSecurityDescriptorW
- ConvertSidToStringSidA
- ConvertSidToStringSidW
- ConvertStringSDToSDDomainA
- ConvertStringSDToSDDomainW
- ConvertStringSDToSDRootDomainA
- ConvertStringSDToSDRootDomainW
- ConvertStringSecurityDescriptorToSecurityDescriptorA
- ConvertStringSecurityDescriptorToSecurityDescriptorW
- ConvertStringSidToSidA
- ConvertStringSidToSidW
- ConvertToAutoInheritPrivateObjectSecurity
- CopySid
- CreateCodeAuthzLevel
- CreatePrivateObjectSecurity
- CreatePrivateObjectSecurityEx
- CreatePrivateObjectSecurityWithMultipleInheritance
- CreateProcessAsUserA
- CreateProcessAsUserW
- CreateProcessWithLogonW
- CreateProcessWithTokenW
- CreateRestrictedToken
- CreateServiceA
- CreateServiceEx
- CreateServiceW
- CreateTraceInstanceId
- CreateWellKnownSid
- CredBackupCredentials
- CredDeleteA
- CredDeleteW
- CredEncryptAndMarshalBinaryBlob
- CredEnumerateA
- CredEnumerateW
- CredFindBestCredentialA
- CredFindBestCredentialW
- CredFree
- CredGetSessionTypes
- CredGetTargetInfoA
- CredGetTargetInfoW
- CredIsMarshaledCredentialA
- CredIsMarshaledCredentialW
- CredIsProtectedA
- CredIsProtectedW
- CredMarshalCredentialA
- CredMarshalCredentialW
- CredpConvertCredential
- CredpConvertOneCredentialSize
- CredpConvertTargetInfo
- CredpDecodeCredential
- CredpEncodeCredential
- CredpEncodeSecret
- CredProfileLoaded
- CredProfileLoadedEx
- CredProfileUnloaded
- CredProtectA
- CredProtectW
- CredReadA
- CredReadByTokenHandle
- CredReadDomainCredentialsA
- CredReadDomainCredentialsW
- CredReadW
- CredRenameA
- CredRenameW
- CredRestoreCredentials
- CredUnmarshalCredentialA
- CredUnmarshalCredentialW
- CredUnprotectA
- CredUnprotectW
- CredWriteA
- CredWriteDomainCredentialsA
- CredWriteDomainCredentialsW
- CredWriteW
- CryptAcquireContextA
- CryptAcquireContextW
- CryptContextAddRef
- CryptCreateHash
- CryptDecrypt
- CryptDeriveKey
- CryptDestroyHash
- CryptDestroyKey
- CryptDuplicateHash
- CryptDuplicateKey
- CryptEncrypt
- CryptEnumProvidersA
- CryptEnumProvidersW
- CryptEnumProviderTypesA
- CryptEnumProviderTypesW
- CryptExportKey
- CryptGenKey
- CryptGenRandom
- CryptGetDefaultProviderA
- CryptGetDefaultProviderW
- CryptGetHashParam
- CryptGetKeyParam
- CryptGetProvParam
- CryptGetUserKey
- CryptHashData
- CryptHashSessionKey
- CryptImportKey
- CryptReleaseContext
- CryptSetHashParam
- CryptSetKeyParam
- CryptSetProviderA
- CryptSetProviderExA
- CryptSetProviderExW
- CryptSetProviderW
- CryptSetProvParam
- CryptSignHashA
- CryptSignHashW
- CryptVerifySignatureA
- CryptVerifySignatureW
- CveEventWrite
- DecryptFileA
- DecryptFileW
- DeleteAce
- DeleteService
- DeregisterEventSource
- DestroyPrivateObjectSecurity
- DuplicateEncryptionInfoFile
- DuplicateToken
- DuplicateTokenEx
- ElfBackupEventLogFileA
- ElfBackupEventLogFileW
- ElfChangeNotify
- ElfClearEventLogFileA
- ElfClearEventLogFileW
- ElfCloseEventLog
- ElfDeregisterEventSource
- ElfFlushEventLog
- ElfNumberOfRecords
- ElfOldestRecord
- ElfOpenBackupEventLogA
- ElfOpenBackupEventLogW
- ElfOpenEventLogA
- ElfOpenEventLogW
- ElfReadEventLogA
- ElfReadEventLogW
- ElfRegisterEventSourceA
- ElfRegisterEventSourceW
- ElfReportEventA
- ElfReportEventAndSourceW
- ElfReportEventW
- EnableTrace
- EnableTraceEx
- EnableTraceEx2
- EncryptedFileKeyInfo
- EncryptFileA
- EncryptFileW
- EncryptionDisable
- EnumDependentServicesA
- EnumDependentServicesW
- EnumDynamicTimeZoneInformation
- EnumerateTraceGuids
- EnumerateTraceGuidsEx
- EnumServiceGroupW
- EnumServicesStatusA
- EnumServicesStatusExA
- EnumServicesStatusExW
- EnumServicesStatusW
- EqualDomainSid
- EqualPrefixSid
- EqualSid
- EventAccessControl
- EventAccessQuery
- EventAccessRemove
- EventActivityIdControl
- EventEnabled
- EventProviderEnabled
- EventRegister
- EventSetInformation
- EventUnregister
- EventWrite
- EventWriteEndScenario
- EventWriteEx
- EventWriteStartScenario
- EventWriteString
- EventWriteTransfer
- FileEncryptionStatusA
- FileEncryptionStatusW
- FindFirstFreeAce
- FlushEfsCache
- FlushTraceA
- FlushTraceW
- FreeEncryptedFileKeyInfo
- FreeEncryptedFileMetadata
- FreeEncryptionCertificateHashList
- FreeInheritedFromArray
- FreeSid
- GetAccessPermissionsForObjectA
- GetAccessPermissionsForObjectW
- GetAce
- GetAclInformation
- GetAuditedPermissionsFromAclA
- GetAuditedPermissionsFromAclW
- GetCurrentHwProfileA
- GetCurrentHwProfileW
- GetDynamicTimeZoneInformationEffectiveYears
- GetEffectiveRightsFromAclA
- GetEffectiveRightsFromAclW
- GetEncryptedFileMetadata
- GetEventLogInformation
- GetExplicitEntriesFromAclA
- GetExplicitEntriesFromAclW
- GetFileSecurityA
- GetFileSecurityW
- GetInformationCodeAuthzLevelW
- GetInformationCodeAuthzPolicyW
- GetInheritanceSourceA
- GetInheritanceSourceW
- GetKernelObjectSecurity
- GetLengthSid
- GetLocalManagedApplicationData
- GetLocalManagedApplications
- GetManagedApplicationCategories
- GetManagedApplications
- GetMultipleTrusteeA
- GetMultipleTrusteeOperationA
- GetMultipleTrusteeOperationW
- GetMultipleTrusteeW
- GetNamedSecurityInfoA
- GetNamedSecurityInfoExA
- GetNamedSecurityInfoExW
- GetNamedSecurityInfoW
- GetNumberOfEventLogRecords
- GetOldestEventLogRecord
- GetOverlappedAccessResults
- GetPrivateObjectSecurity
- GetSecurityDescriptorControl
- GetSecurityDescriptorDacl
- GetSecurityDescriptorGroup
- GetSecurityDescriptorLength
- GetSecurityDescriptorOwner
- GetSecurityDescriptorRMControl
- GetSecurityDescriptorSacl
- GetSecurityInfo
- GetSecurityInfoExA
- GetSecurityInfoExW
- GetServiceDisplayNameA
- GetServiceDisplayNameW
- GetServiceKeyNameA
- GetServiceKeyNameW
- GetSidIdentifierAuthority
- GetSidLengthRequired
- GetSidSubAuthority
- GetSidSubAuthorityCount
- GetStringConditionFromBinary
- GetThreadWaitChain
- GetTokenInformation
- GetTraceEnableFlags
- GetTraceEnableLevel
- GetTraceLoggerHandle
- GetTrusteeFormA
- GetTrusteeFormW
- GetTrusteeNameA
- GetTrusteeNameW
- GetTrusteeTypeA
- GetTrusteeTypeW
- GetUserNameA
- GetUserNameW
- GetWindowsAccountDomainSid
- I_QueryTagInformation
- I_ScGetCurrentGroupStateW
- I_ScIsSecurityProcess
- I_ScPnPGetServiceName
- I_ScQueryServiceConfig
- I_ScRegisterPreshutdownRestart
- I_ScReparseServiceDatabase
- I_ScSendPnPMessage
- I_ScSendTSMessage
- I_ScSetServiceBitsA
- I_ScSetServiceBitsW
- I_ScValidatePnPService
- IdentifyCodeAuthzLevelW
- ImpersonateAnonymousToken
- ImpersonateLoggedOnUser
- ImpersonateNamedPipeClient
- ImpersonateSelf
- InitializeAcl
- InitializeSecurityDescriptor
- InitializeSid
- InitiateShutdownA
- InitiateShutdownW
- InitiateSystemShutdownA
- InitiateSystemShutdownExA
- InitiateSystemShutdownExW
- InitiateSystemShutdownW
- InstallApplication
- IsTextUnicode
- IsTokenRestricted
- IsTokenUntrusted
- IsValidAcl
- IsValidRelativeSecurityDescriptor
- IsValidSecurityDescriptor
- IsValidSid
- IsWellKnownSid
- LockServiceDatabase
- LogonUserA
- LogonUserExA
- LogonUserExExW
- LogonUserExW
- LogonUserW
- LookupAccountNameA
- LookupAccountNameW
- LookupAccountSidA
- LookupAccountSidW
- LookupPrivilegeDisplayNameA
- LookupPrivilegeDisplayNameW
- LookupPrivilegeNameA
- LookupPrivilegeNameW
- LookupPrivilegeValueA
- LookupPrivilegeValueW
- LookupSecurityDescriptorPartsA
- LookupSecurityDescriptorPartsW
- LsaAddAccountRights
- LsaAddPrivilegesToAccount
- LsaClearAuditLog
- LsaClose
- LsaCreateAccount
- LsaCreateSecret
- LsaCreateTrustedDomain
- LsaCreateTrustedDomainEx
- LsaDelete
- LsaDeleteTrustedDomain
- LsaEnumerateAccountRights
- LsaEnumerateAccounts
- LsaEnumerateAccountsWithUserRight
- LsaEnumeratePrivileges
- LsaEnumeratePrivilegesOfAccount
- LsaEnumerateTrustedDomains
- LsaEnumerateTrustedDomainsEx
- LsaFreeMemory
- LsaGetAppliedCAPIDs
- LsaGetQuotasForAccount
- LsaGetRemoteUserName
- LsaGetSystemAccessAccount
- LsaGetUserName
- LsaICLookupNames
- LsaICLookupNamesWithCreds
- LsaICLookupSids
- LsaICLookupSidsWithCreds
- LsaInvokeTrustScanner
- LsaLookupNames
- LsaLookupNames2
- LsaLookupPrivilegeDisplayName
- LsaLookupPrivilegeName
- LsaLookupPrivilegeValue
- LsaLookupSids
- LsaLookupSids2
- LsaManageSidNameMapping
- LsaNtStatusToWinError
- LsaOpenAccount
- LsaOpenPolicy
- LsaOpenPolicySce
- LsaOpenSecret
- LsaOpenTrustedDomain
- LsaOpenTrustedDomainByName
- LsaQueryCAPs
- LsaQueryDomainInformationPolicy
- LsaQueryForestTrustInformation
- LsaQueryForestTrustInformation2
- LsaQueryInformationPolicy
- LsaQueryInfoTrustedDomain
- LsaQuerySecret
- LsaQuerySecurityObject
- LsaQueryTrustedDomainInfo
- LsaQueryTrustedDomainInfoByName
- LsaRemoveAccountRights
- LsaRemovePrivilegesFromAccount
- LsaRetrievePrivateData
- LsaSetCAPs
- LsaSetDomainInformationPolicy
- LsaSetForestTrustInformation
- LsaSetForestTrustInformation2
- LsaSetInformationPolicy
- LsaSetInformationTrustedDomain
- LsaSetQuotasForAccount
- LsaSetSecret
- LsaSetSecurityObject
- LsaSetSystemAccessAccount
- LsaSetTrustedDomainInfoByName
- LsaSetTrustedDomainInformation
- LsaStorePrivateData
- MakeAbsoluteSD
- MakeAbsoluteSD2
- MakeSelfRelativeSD
- MapGenericMask
- MD4Final
- MD4Init
- MD4Update
- MD5Final
- MD5Init
- MD5Update
- MIDL_user_free_Ext
- MSChapSrvChangePassword
- MSChapSrvChangePassword2
- NotifyBootConfigStatus
- NotifyChangeEventLog
- NotifyServiceStatusChange
- NotifyServiceStatusChangeA
- NotifyServiceStatusChangeW
- NpGetUserName
- ObjectCloseAuditAlarmA
- ObjectCloseAuditAlarmW
- ObjectDeleteAuditAlarmA
- ObjectDeleteAuditAlarmW
- ObjectOpenAuditAlarmA
- ObjectOpenAuditAlarmW
- ObjectPrivilegeAuditAlarmA
- ObjectPrivilegeAuditAlarmW
- OpenBackupEventLogA
- OpenBackupEventLogW
- OpenEncryptedFileRawA
- OpenEncryptedFileRawW
- OpenEventLogA
- OpenEventLogW
- OpenProcessToken
- OpenSCManagerA
- OpenSCManagerW
- OpenServiceA
- OpenServiceW
- OpenThreadToken
- OpenThreadWaitChainSession
- OpenTraceA
- OpenTraceW
- OperationEnd
- OperationStart
- PerfAddCounters
- PerfCloseQueryHandle
- PerfCreateInstance
- PerfDecrementULongCounterValue
- PerfDecrementULongLongCounterValue
- PerfDeleteCounters
- PerfDeleteInstance
- PerfEnumerateCounterSet
- PerfEnumerateCounterSetInstances
- PerfIncrementULongCounterValue
- PerfIncrementULongLongCounterValue
- PerfOpenQueryHandle
- PerfQueryCounterData
- PerfQueryCounterInfo
- PerfQueryCounterSetRegistrationInfo
- PerfQueryInstance
- PerfRegCloseKey
- PerfRegEnumKey
- PerfRegEnumValue
- PerfRegQueryInfoKey
- PerfRegQueryValue
- PerfRegSetValue
- PerfSetCounterRefValue
- PerfSetCounterSetInfo
- PerfSetULongCounterValue
- PerfSetULongLongCounterValue
- PerfStartProvider
- PerfStartProviderEx
- PerfStopProvider
- PrivilegeCheck
- PrivilegedServiceAuditAlarmA
- PrivilegedServiceAuditAlarmW
- ProcessIdleTasks
- ProcessIdleTasksW
- ProcessTrace
- QueryAllTracesA
- QueryAllTracesW
- QueryLocalUserServiceName
- QueryRecoveryAgentsOnEncryptedFile
- QuerySecurityAccessMask
- QueryServiceConfig2A
- QueryServiceConfig2W
- QueryServiceConfigA
- QueryServiceConfigW
- QueryServiceDynamicInformation
- QueryServiceLockStatusA
- QueryServiceLockStatusW
- QueryServiceObjectSecurity
- QueryServiceStatus
- QueryServiceStatusEx
- QueryTraceA
- QueryTraceProcessingHandle
- QueryTraceW
- QueryUserServiceName
- QueryUserServiceNameForContext
- QueryUsersOnEncryptedFile
- ReadEncryptedFileRaw
- ReadEventLogA
- ReadEventLogW
- RegCloseKey
- RegConnectRegistryA
- RegConnectRegistryExA
- RegConnectRegistryExW
- RegConnectRegistryW
- RegCopyTreeA
- RegCopyTreeW
- RegCreateKeyA
- RegCreateKeyExA
- RegCreateKeyExW
- RegCreateKeyTransactedA
- RegCreateKeyTransactedW
- RegCreateKeyW
- RegDeleteKeyA
- RegDeleteKeyExA
- RegDeleteKeyExW
- RegDeleteKeyTransactedA
- RegDeleteKeyTransactedW
- RegDeleteKeyValueA
- RegDeleteKeyValueW
- RegDeleteKeyW
- RegDeleteTreeA
- RegDeleteTreeW
- RegDeleteValueA
- RegDeleteValueW
- RegDisablePredefinedCache
- RegDisablePredefinedCacheEx
- RegDisableReflectionKey
- RegEnableReflectionKey
- RegEnumKeyA
- RegEnumKeyExA
- RegEnumKeyExW
- RegEnumKeyW
- RegEnumValueA
- RegEnumValueW
- RegFlushKey
- RegGetKeySecurity
- RegGetValueA
- RegGetValueW
- RegisterEventSourceA
- RegisterEventSourceW
- RegisterIdleTask
- RegisterServiceCtrlHandlerA
- RegisterServiceCtrlHandlerExA
- RegisterServiceCtrlHandlerExW
- RegisterServiceCtrlHandlerW
- RegisterTraceGuidsA
- RegisterTraceGuidsW
- RegisterWaitChainCOMCallback
- RegLoadAppKeyA
- RegLoadAppKeyW
- RegLoadKeyA
- RegLoadKeyW
- RegLoadMUIStringA
- RegLoadMUIStringW
- RegNotifyChangeKeyValue
- RegOpenCurrentUser
- RegOpenKeyA
- RegOpenKeyExA
- RegOpenKeyExW
- RegOpenKeyTransactedA
- RegOpenKeyTransactedW
- RegOpenKeyW
- RegOpenUserClassesRoot
- RegOverridePredefKey
- RegQueryInfoKeyA
- RegQueryInfoKeyW
- RegQueryMultipleValuesA
- RegQueryMultipleValuesW
- RegQueryReflectionKey
- RegQueryValueA
- RegQueryValueExA
- RegQueryValueExW
- RegQueryValueW
- RegRenameKey
- RegReplaceKeyA
- RegReplaceKeyW
- RegRestoreKeyA
- RegRestoreKeyW
- RegSaveKeyA
- RegSaveKeyExA
- RegSaveKeyExW
- RegSaveKeyW
- RegSetKeySecurity
- RegSetKeyValueA
- RegSetKeyValueW
- RegSetValueA
- RegSetValueExA
- RegSetValueExW
- RegSetValueW
- RegUnLoadKeyA
- RegUnLoadKeyW
- RemoteRegEnumKeyWrapper
- RemoteRegEnumValueWrapper
- RemoteRegQueryInfoKeyWrapper
- RemoteRegQueryMultipleValues2Wrapper
- RemoteRegQueryMultipleValuesWrapper
- RemoteRegQueryValueWrapper
- RemoveTraceCallback
- RemoveUsersFromEncryptedFile
- ReportEventA
- ReportEventW
- RevertToSelf
- SafeBaseRegGetKeySecurity
- SaferCloseLevel
- SaferComputeTokenFromLevel
- SaferCreateLevel
- SaferGetLevelInformation
- SaferGetPolicyInformation
- SaferiChangeRegistryScope
- SaferiCompareTokenLevels
- SaferIdentifyLevel
- SaferiIsDllAllowed
- SaferiIsExecutableFileType
- SaferiPopulateDefaultsInRegistry
- SaferiRecordEventLogEntry
- SaferiSearchMatchingHashRules
- SaferRecordEventLogEntry
- SaferSetLevelInformation
- SaferSetPolicyInformation
- SetAclInformation
- SetEncryptedFileMetadata
- SetEntriesInAccessListA
- SetEntriesInAccessListW
- SetEntriesInAclA
- SetEntriesInAclW
- SetEntriesInAuditListA
- SetEntriesInAuditListW
- SetFileSecurityA
- SetFileSecurityW
- SetInformationCodeAuthzLevelW
- SetInformationCodeAuthzPolicyW
- SetKernelObjectSecurity
- SetNamedSecurityInfoA
- SetNamedSecurityInfoExA
- SetNamedSecurityInfoExW
- SetNamedSecurityInfoW
- SetPrivateObjectSecurity
- SetPrivateObjectSecurityEx
- SetSecurityAccessMask
- SetSecurityDescriptorControl
- SetSecurityDescriptorDacl
- SetSecurityDescriptorGroup
- SetSecurityDescriptorOwner
- SetSecurityDescriptorRMControl
- SetSecurityDescriptorSacl
- SetSecurityInfo
- SetSecurityInfoExA
- SetSecurityInfoExW
- SetServiceBits
- SetServiceObjectSecurity
- SetServiceStatus
- SetThreadToken
- SetTokenInformation
- SetTraceCallback
- SetUserFileEncryptionKey
- SetUserFileEncryptionKeyEx
- StartServiceA
- StartServiceCtrlDispatcherA
- StartServiceCtrlDispatcherW
- StartServiceW
- StartTraceA
- StartTraceW
- StopTraceA
- StopTraceW
- SystemFunction001
- SystemFunction002
- SystemFunction003
- SystemFunction004
- SystemFunction005
- SystemFunction006
- SystemFunction007
- SystemFunction008
- SystemFunction009
- SystemFunction010
- SystemFunction011
- SystemFunction012
- SystemFunction013
- SystemFunction014
- SystemFunction015
- SystemFunction016
- SystemFunction017
- SystemFunction018
- SystemFunction019
- SystemFunction020
- SystemFunction021
- SystemFunction022
- SystemFunction023
- SystemFunction024
- SystemFunction025
- SystemFunction026
- SystemFunction027
- SystemFunction028
- SystemFunction029
- SystemFunction030
- SystemFunction031
- SystemFunction032
- SystemFunction033
- SystemFunction034
- SystemFunction035
- SystemFunction036
- SystemFunction040
- SystemFunction041
- TraceEvent
- TraceEventInstance
- TraceMessage
- TraceMessageVa
- TraceQueryInformation
- TraceSetInformation
- TreeResetNamedSecurityInfoA
- TreeResetNamedSecurityInfoW
- TreeSetNamedSecurityInfoA
- TreeSetNamedSecurityInfoW
- TrusteeAccessToObjectA
- TrusteeAccessToObjectW
- UninstallApplication
- UnlockServiceDatabase
- UnregisterIdleTask
- UnregisterTraceGuids
- UpdateTraceA
- UpdateTraceW
- UsePinForEncryptedFilesA
- UsePinForEncryptedFilesW
- WaitServiceState
- WmiCloseBlock
- WmiDevInstToInstanceNameA
- WmiDevInstToInstanceNameW
- WmiEnumerateGuids
- WmiExecuteMethodA
- WmiExecuteMethodW
- WmiFileHandleToInstanceNameA
- WmiFileHandleToInstanceNameW
- WmiFreeBuffer
- WmiMofEnumerateResourcesA
- WmiMofEnumerateResourcesW
- WmiNotificationRegistrationA
- WmiNotificationRegistrationW
- WmiOpenBlock
- WmiQueryAllDataA
- WmiQueryAllDataMultipleA
- WmiQueryAllDataMultipleW
- WmiQueryAllDataW
- WmiQueryGuidInformation
- WmiQuerySingleInstanceA
- WmiQuerySingleInstanceMultipleA
- WmiQuerySingleInstanceMultipleW
- WmiQuerySingleInstanceW
- WmiReceiveNotificationsA
- WmiReceiveNotificationsW
- WmiSetSingleInstanceA
- WmiSetSingleInstanceW
- WmiSetSingleItemA
- WmiSetSingleItemW
- WriteEncryptedFileRaw
